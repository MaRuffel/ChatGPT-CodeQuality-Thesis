Without a clear understanding of the context and purpose of the code, it is difficult to suggest specific improvements. However, here are some general suggestions that could potentially improve the code:

Use more descriptive variable names: The variable names used in the code are often cryptic and not very informative. Using more descriptive names can make the code easier to understand and maintain.

Simplify control flow: The code contains a lot of nested loops and conditionals, which can make it hard to follow. Simplifying the control flow by breaking it up into smaller functions or using early returns can make the code easier to read.

Use functional programming techniques: The code makes use of mutable state and imperative programming techniques. Using functional programming techniques such as immutability and pure functions can make the code more readable and less error-prone.

Consider using the Optional type: The code uses null checks to handle empty values. Using the Optional type can make the code more expressive and safer.

Add comments: The code contains a lot of implementation details that may not be immediately obvious to someone reading it for the first time. Adding comments can make the code easier to understand and maintain.